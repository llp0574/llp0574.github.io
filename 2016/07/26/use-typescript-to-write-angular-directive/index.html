<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        如何使用 TypeScript 编写自定义 AngularJS 指令？ | llp的程序猿之路
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="llp">
    <meta name="description" content="llp的程序猿之路走得磕磕绊绊">
    <meta name="keywords" content="null">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="llp的程序猿之路">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://llp0574.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="如何使用 TypeScript 编写自定义 AngularJS 指令？ | llp的程序猿之路">
    <meta property="og:description" content="llp的程序猿之路走得磕磕绊绊">

     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>

	<link rel="stylesheet" href="/css/highlight/solarized-white.css">


	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>

    <!-- Custom Head -->
    

    
<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?73bb3e6eceb47c2e2f8f79e3bf611006";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#什么是指令？"><span class="post-toc-number">1.</span> <span class="post-toc-text">什么是指令？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#例子"><span class="post-toc-number">2.</span> <span class="post-toc-text">例子</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#标准化过程"><span class="post-toc-number">3.</span> <span class="post-toc-text">标准化过程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#最佳实践"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">最佳实践</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#指令的类型"><span class="post-toc-number">4.</span> <span class="post-toc-text">指令的类型</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#最佳实践-1"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">最佳实践</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#TypeScript-中的自定义指令"><span class="post-toc-number">5.</span> <span class="post-toc-text">TypeScript 中的自定义指令</span></a></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		<!-- Custom Thumbnail -->
		<div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(/img/angularjstypescript.png)">
	
        <p class="article-headline-p">
            如何使用 TypeScript 编写自定义 AngularJS 指令？
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>llp</strong>
        <span>7月 26, 2016</span>
    </div>

    <div class="section-spacer"></div>

    <span class="post-count">共计&nbsp;1,697&nbsp;字&nbsp;&nbsp;|&nbsp;&nbsp;</span>
    <span class="post-read">预计阅读&nbsp;7&nbsp;分钟&nbsp;&nbsp;</span>
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->

    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/AngularJS/">AngularJS</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/JavaScript/">JavaScript</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/TypeScript/">TypeScript</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/前端/">前端</a>
    </ul>

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/2016/07/26/use-typescript-to-write-angular-directive/" class="leancloud-views_num" data-flag-title="如何使用 TypeScript 编写自定义 AngularJS 指令？">
     &nbsp;浏览量
</span>
        </li>
    </a>
    
    
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=如何使用 TypeScript 编写自定义 AngularJS 指令？&url=http://llp0574.github.io//2016/07/26/use-typescript-to-write-angular-directive/index.html&via=llp" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://llp0574.github.io//2016/07/26/use-typescript-to-write-angular-directive/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=如何使用 TypeScript 编写自定义 AngularJS 指令？&url=http://llp0574.github.io//2016/07/26/use-typescript-to-write-angular-directive/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<blockquote>
<p>原文链接 : <a href="http://www.siddharthpandey.net/how-to-write-custom-angularjs-directive-using-typescript/" target="_blank" rel="external">How to write custom AngularJS Directive using TypeScript?</a><br>原文作者 : <a href="http://www.siddharthpandey.net/" target="_blank" rel="external">Siddharth Pandey</a><br>译者 : <a href="https://github.com/llp0574" target="_blank" rel="external">llp</a>（web前端领域）<br>译者注：翻译如有疏漏，欢迎指出！感谢！转载请保留此头部。</p>
</blockquote>
<p><a href="https://angularjs.org/" target="_blank" rel="external">AngularJS</a> 框架有很多强大的特性，其中指令(Directives)是广为人知的。在这篇文章中，我将告诉你如何用 TypeScript 编写自定义 AngularJS 指令。首先，我将讲一下关于指令的基本知识，但如果你想直接看 TypeScript 代码的，你可以<a href="https://segmentfault.com/a/1190000006075565#articleHeader4" target="_blank" rel="external">跳过基本</a>。</p>
<h3 id="什么是指令？"><a href="#什么是指令？" class="headerlink" title="什么是指令？"></a>什么是指令？</h3><blockquote>
<p>在较高层面上，指令是一个 DOM 元素的标记（像一个属性，元素名称，注释或者 CSS 类），它告诉 Angular 的 HTML 编译器（<code>$compiler</code>）去给 DOM 元素连接一个特殊的行为（例如通过事件监听），或者甚至是改变这个 DOM 元素和其子元素。</p>
<p>Angular 本身有一些内建的指令，像 <code>ngbind</code>,<code>ngModel</code>和 <code>ngClass</code>。就像你创建控制器（controllers）和服务（services）那样，你可以创建自己的指令给 Angular 使用。当 Angular <a href="https://docs.angularjs.org/guide/bootstrap" target="_blank" rel="external">启动</a>你的应用时，<a href="https://docs.angularjs.org/guide/compiler" target="_blank" rel="external">HTML 编译器</a>就会对 DOM 元素进行遍历找到符合的指令。</p>
<p>-<a href="https://docs.angularjs.org/guide/directive" target="_blank" rel="external">AngualrJS 文档</a></p>
</blockquote>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>看看<code>ng-controller</code>和<code>ng-bind</code>这些 AngularJS 框架自带指令的使用方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-controller=&quot;Controller&quot;&gt;</div><div class="line">  Hello &lt;input ng-model=&apos;name&apos;&gt; &lt;hr/&gt;</div><div class="line">  &lt;span data-ng-bind=&quot;name&quot;&gt;&lt;/span&gt; &lt;br/&gt;</div><div class="line">  &lt;span ng:bind=&quot;name&quot;&gt;&lt;/span&gt; &lt;br/&gt;</div><div class="line">  &lt;span ng_bind=&quot;name&quot;&gt;&lt;/span&gt; &lt;br/&gt;</div><div class="line">  &lt;span data-ng-bind=&quot;name&quot;&gt;&lt;/span&gt; &lt;br/&gt;</div><div class="line">  &lt;span x-ng-bind=&quot;name&quot;&gt;&lt;/span&gt; &lt;br/&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<h3 id="标准化过程"><a href="#标准化过程" class="headerlink" title="标准化过程"></a>标准化过程</h3><p>上面的代码片段，有多种方式去标记一个指令。AngularJS 的 HTML 编译器负责决定哪个元素匹配哪个指令，一般通过区分大小写的 <code>camelCase</code>（驼峰式） 命名方法（如 <code>ngModel</code>）去使用指令。但是，因为 HTML 是不区分大小写的，一般我们使用小写形式的 <em>短横线-分隔</em> 属性写在 DOM 元素上（如<code>ng-model</code>）。</p>
<p>标准化过程如下：</p>
<ol>
<li>前面的元素或属性使用带<code>x-</code>或<code>data-</code>的形式。</li>
<li>将<code>:</code>,<code>-</code>或<code>_</code>这些分隔符转化为<code>camelCase</code>（驼峰式）。</li>
</ol>
<h4 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h4><p>最好使用 <em>短横线-分隔</em> 格式（如 <code>ng-bind</code> 对应 <code>ngBind</code>）。如果你想使用一个 HTML 验证工具，可以使用 <em>带data前缀</em> 的版本进行替代（如 <code>data-ng-bind</code> 对应 <code>ngBind</code>）。上面展示的其他形式因遗留原因仍然可以使用当还是建议避免使用它们。</p>
<h3 id="指令的类型"><a href="#指令的类型" class="headerlink" title="指令的类型"></a>指令的类型</h3><p>AngularJS 的 HTML 编译器如<code>$compiler</code>可以基于元素名，属性，类名，还有注释去匹配指令。下面的例子展示了一个名为<code>myDir</code>的指令在一个 HTML 模板里是怎么用多种方式去引用的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;my-dir&gt;&lt;/my-dir&gt;</div><div class="line">&lt;span my-dir=&quot;exp&quot;&gt;&lt;/span&gt;</div><div class="line">&lt;!-- directive: my-dir exp --&gt;</div><div class="line">&lt;span class=&quot;my-dir: exp;&quot;&gt;&lt;/span&gt;</div></pre></td></tr></table></figure>
<h4 id="最佳实践-1"><a href="#最佳实践-1" class="headerlink" title="最佳实践"></a>最佳实践</h4><p>最好通过标签名或者属性而不是注释和类名去使用指令。这样做通常会更容易去决定哪个指令匹配给定的元素。</p>
<p>注释指令通常在 DOM API 限制跨越多个元素创建指令的地方使用（如<code>table</code>元素）。AngularJS 1.2 采用了<code>ng-repeat-start</code>和<code>ng-repeat-end</code>作为解决这个问题更好的方法，鼓励开发者尽量使用这个方法代替注释指令。</p>
<h3 id="TypeScript-中的自定义指令"><a href="#TypeScript-中的自定义指令" class="headerlink" title="TypeScript 中的自定义指令"></a>TypeScript 中的自定义指令</h3><p>让我们来创建一个只为任何的块，小部件或者人名在右边添加标题，子标题和文本的指令。这是一个很好的例子，因为它可以在很多地方重用而且可以作为一个有隔离作用域的指令在每个动态加载的块中作为信息展示。</p>
<p>来看看 HTML，Typescript 的代码在其下方：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;widget-head&quot;&gt;</div><div class="line">  &lt;div class=&quot;page-title pull-left&quot;&gt;&#123;&#123;title&#125;&#125;&lt;/div&gt;</div><div class="line">  &lt;small class=&quot;page-title-subtle&quot; ng-show=&quot;subtitle&quot;&gt;(&#123;&#123;subtitle&#125;&#125;)&lt;/small&gt;</div><div class="line">  &lt;div class=&quot;widget-icons pull-right&quot;&gt;&lt;/div&gt;</div><div class="line">  &lt;small class=&quot;pull-right page-title-subtle&quot; ng-show=&quot;rightText&quot;&gt;&#123;&#123;rightText&#125;&#125;&lt;/small&gt;</div><div class="line">  &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line"></div><div class="line">interface IHtWidgetHeaderScope &#123;</div><div class="line">  title: string;</div><div class="line">  subtitle: string;</div><div class="line">  rightText: string;</div><div class="line">  allowCollapse: string;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//Usage:</div><div class="line">//&lt;div ht-widget-header title=&quot;vm.map.title&quot;&gt;&lt;/div&gt;</div><div class="line">// Creates:</div><div class="line">// &lt;div ht-widget-header=&quot;&quot;</div><div class="line">//      title=&quot;Movie&quot;</div><div class="line">//&lt;/div&gt;</div><div class="line">class HtWidgetHeader implements ng.IDirective &#123;</div><div class="line">  static $inject: Array&lt;string&gt; = [&apos;&apos;];</div><div class="line">  constructor() &#123; &#125;</div><div class="line"></div><div class="line">  static instance(): ng.IDirective &#123;</div><div class="line">    return new HtWidgetHeader();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  scope: IHtWidgetHeaderScope = &#123;</div><div class="line">    &apos;title&apos;: &apos;@&apos;,</div><div class="line">    &apos;subtitle&apos;: &apos;@&apos;,</div><div class="line">    &apos;rightText&apos;: &apos;@&apos;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">  templateUrl: string = &apos;app/widgets/widget-header.html&apos;;</div><div class="line">  restrict: string = &apos;EA&apos;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">angular.module(&apos;app&apos;).directive(&apos;htWidgetHeader&apos;, HtWidgetHeader.instance);</div></pre></td></tr></table></figure>
<p>利用 TypeScript 的特点，创建一个定义了可在指令内使用的作用域成员的接口（interface）。同样地我们想创建一个指令的实例，我们就定义一个实现了<code>IDirective</code>的类（class）。</p>
<p>要想知道类型定义，看看<a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="external">这个令人吃惊的仓库</a>，它收集了几乎所有流行的 JavaScript 库。这些类型定义可以让我们得到任何编译时错误和 <a href="https://en.wikipedia.org/wiki/Integrated_development_environment" target="_blank" rel="external">IDE</a> 的智能支持。我使用 Visual Studio 和 Visual Code，它们都对 TypeScript 有很好的支持。</p>
<p>这个指令不需要任何内建的 angular 服务或任何依赖，所以 <code>$inject</code> 这个静态成员只是一个空数组。如果依赖被列出来的话，框架就会根据这个变量的内容去寻找然后依赖注入。</p>
<p>构造器（constructor）不用做什么事情但我们还是需要一个静态的 <code>instance</code> 方法去创建一个指令的实例。框架会在定义一个使用了模块指令 API 的时候期望一个指令的实例。</p>
<p>这个类的 <code>scope</code> 在这里非常重要，因为这个指令使用隔离的作用域，即它自身的成员变量可以在这个指令的模板当中使用但并不继承外层或其父级作用域的声明。为了可读性和可维护性，我们使用了 <code>templateUrl</code> 去指定模板的源码。另外，<code>restrict</code> 设置了指令的使用级别给元素和属性，分别使用 E 和 A 表示。</p>
<p><code>restrict</code> 选项一般设置为：</p>
<ul>
<li>‘A’：只匹配属性名</li>
<li>‘E’：只匹配元素名</li>
<li>‘C’：只匹配类名</li>
<li>‘M’：只匹配注释</li>
</ul>
<p>这些限制只要需要都可以结合：’AEC’ 匹配属性或元素或类名。</p>
<p>现在可以像下面的代码片段那样使用这个指令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div ht-widget-header title=&quot;&#123;&#123;vm.title&#125;&#125;&quot; subtitle=&quot;&#123;&#123;vm.description&#125;&#125;&quot; right-text=&quot;&#123;&#123;vm.refreshedDateTimeInfo&#125;&#125;&quot;&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>这个指令可以在给到一个硬编码或者动态的 <code>title</code>，<code>subtitle</code> 或者 <code>right-text</code>作用域成员的情况下作为元素或者属性使用。注意到后者和任何指令一样都已经被编译器标准化。上面的代码片段在一个模板里使用，该模板链接到一个含有 <code>title</code>，<code>description</code> 和 <code>refreshedDateTimeInfo</code> 变量的控制器，然后展示给用户。给定一些标记和设计，就会像下面这样：</p>
<p><img src="http://i1.wp.com/www.siddharthpandey.net/wp-content/uploads/2016/04/Screen-Shot-2016-05-01-at-18.21.20.png?w=511" alt=""></p>
<p>如果你想学到更多有关如何整合 AngularJS 和 TypeScript 的知识，可以看看<a href="http://www.siddharthpandey.net/tag/angularjs/" target="_blank" rel="external">我的 AngularJS 文章</a>。如果你想学习其他一些特别的东西可以联系我，我会尝试写相关文章的。</p>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2016/07/26/use-typescript-to-write-angular-directive/" 
            data-url="http://llp0574.github.io/2016/07/26/use-typescript-to-write-angular-directive/"
            data-title="如何使用 TypeScript 编写自定义 AngularJS 指令？"></div>
    <!-- 多说评论框 end -->
</div>



            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    
        <a href="/2016/07/27/use-typescript-to-write-angular-controller/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/07/22/angular-controller-data-share/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="llp's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        llp0574@gmail.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="mailto:llp0574@gmail.com" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/01/">一月 2016<span class="sidebar_archives-count">2</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="/about" title="关于我">
				关于我
			</a>
		</li>
	
		<li>
			<a href="/tags" title="标签云">
				标签云
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">14</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/u/1806141607" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/llp0574" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;llp的程序猿之路</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>




    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("dFsFONvyzhvCLBqr0vdTUuQI-gzGzoHsz", "gKQoW3SRT0IvN2krRAjKgAL2");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>





    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"llp0574"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
